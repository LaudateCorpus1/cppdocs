


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Program Listing for File Exception.h &mdash; PyTorch master documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://pytorch.org/docs/stable/api/program_listing_file_c10_util_Exception.h.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../_static/collapsible-lists/css/tree_view.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/features">Features</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li class="active">
            <a href="https://pytorch.org/docs/stable/index.html">Docs</a>
          </li>

          <li>
            <a href="https://pytorch.org/resources">Resources</a>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  master
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing C++ Distributions of PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frontend.html">The C++ Frontend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="library_root.html">Library API</a></li>
</ul>
<p class="caption"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notes/faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/tensor_basics.html">Tensor Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/tensor_creation.html">Tensor Creation API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Program Listing for File Exception.h</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            
              <!-- User defined GitHub URL -->
              <a href="https://github.com/pytorch/pytorch" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <div class="section" id="program-listing-for-file-exception-h">
<span id="program-listing-file-c10-util-exception-h"></span><h1>Program Listing for File Exception.h<a class="headerlink" href="#program-listing-for-file-exception-h" title="Permalink to this headline">¶</a></h1>
<p>↰ <a class="reference internal" href="file_c10_util_Exception.h.html#file-c10-util-exception-h"><span class="std std-ref">Return to documentation for file</span></a> (<code class="docutils literal notranslate"><span class="pre">c10/util/Exception.h</span></code>)</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef C10_UTIL_EXCEPTION_H_</span>
<span class="cp">#define C10_UTIL_EXCEPTION_H_</span>

<span class="cp">#include</span> <span class="cpf">&quot;c10/macros/Macros.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;c10/util/StringUtil.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;c10/util/Deprecated.h&quot;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&lt;cstddef&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;exception&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;ostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;sstream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp"></span>

<span class="cp">#if defined(_MSC_VER) &amp;&amp; _MSC_VER &lt;= 1900</span>
<span class="cp">#define __func__ __FUNCTION__</span>
<span class="cp">#endif</span>

<span class="k">namespace</span> <span class="n">c10</span> <span class="p">{</span>

<span class="k">class</span> <span class="nc">C10_API</span> <span class="nl">Error</span> <span class="p">:</span> <span class="k">public</span> <span class="n">std</span><span class="o">::</span><span class="n">exception</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">msg_stack_</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">backtrace_</span><span class="p">;</span>

  <span class="c1">// These two are derived fields from msg_stack_ and backtrace_, but we need</span>
  <span class="c1">// fields for the strings so that we can return a const char* (as the</span>
  <span class="c1">// signature of std::exception requires).</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">msg_</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">msg_without_backtrace_</span><span class="p">;</span>

  <span class="c1">// This is a little debugging trick: you can stash a relevant pointer</span>
  <span class="c1">// in caller, and then when you catch the exception, you can compare</span>
  <span class="c1">// against pointers you have on hand to get more information about</span>
  <span class="c1">// where the exception came from.  In Caffe2, this is used to figure</span>
  <span class="c1">// out which operator raised an exception.</span>
  <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">caller_</span><span class="p">;</span>

 <span class="k">public</span><span class="o">:</span>
  <span class="n">Error</span><span class="p">(</span>
      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">msg</span><span class="p">,</span>
      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">backtrace</span><span class="p">,</span>
      <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">caller</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">);</span>
  <span class="n">Error</span><span class="p">(</span><span class="n">SourceLocation</span> <span class="n">source_location</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">msg</span><span class="p">);</span>
  <span class="n">Error</span><span class="p">(</span>
      <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">file</span><span class="p">,</span>
      <span class="k">const</span> <span class="kt">uint32_t</span> <span class="n">line</span><span class="p">,</span>
      <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">condition</span><span class="p">,</span>
      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">msg</span><span class="p">,</span>
      <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">backtrace</span><span class="p">,</span>
      <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">caller</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">);</span>

  <span class="kt">void</span> <span class="nf">AppendMessage</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">msg</span><span class="p">);</span>

  <span class="c1">// Compute the full message from msg_ and msg_without_backtrace_</span>
  <span class="c1">// TODO: Maybe this should be private</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">msg</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">msg_without_backtrace</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>

  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;&amp;</span> <span class="n">msg_stack</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">msg_stack_</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">what</span><span class="p">()</span> <span class="k">const</span> <span class="k">noexcept</span> <span class="k">override</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">msg_</span><span class="p">.</span><span class="n">c_str</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">caller</span><span class="p">()</span> <span class="k">const</span> <span class="k">noexcept</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">caller_</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">what_without_backtrace</span><span class="p">()</span> <span class="k">const</span> <span class="k">noexcept</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">msg_without_backtrace_</span><span class="p">.</span><span class="n">c_str</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">C10_API</span> <span class="n">Warning</span> <span class="p">{</span>
  <span class="k">using</span> <span class="n">handler_t</span> <span class="o">=</span>
      <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="p">)(</span><span class="k">const</span> <span class="n">SourceLocation</span><span class="o">&amp;</span> <span class="n">source_location</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">msg</span><span class="p">);</span>

 <span class="k">public</span><span class="o">:</span>
  <span class="k">static</span> <span class="kt">void</span> <span class="n">warn</span><span class="p">(</span><span class="n">SourceLocation</span> <span class="n">source_location</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">msg</span><span class="p">);</span>
  <span class="k">static</span> <span class="kt">void</span> <span class="nf">set_warning_handler</span><span class="p">(</span><span class="n">handler_t</span> <span class="n">handler</span><span class="p">);</span>
  <span class="k">static</span> <span class="kt">void</span> <span class="nf">print_warning</span><span class="p">(</span>
      <span class="k">const</span> <span class="n">SourceLocation</span><span class="o">&amp;</span> <span class="n">source_location</span><span class="p">,</span>
      <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">msg</span><span class="p">);</span>

 <span class="k">private</span><span class="o">:</span>
  <span class="k">static</span> <span class="n">handler_t</span> <span class="n">warning_handler_</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Used in ATen for out-of-bound indices that can reasonably only be detected</span>
<span class="c1">// lazily inside a kernel (See: advanced indexing).  These turn into</span>
<span class="c1">// IndexError when they cross to Python.</span>
<span class="k">class</span> <span class="nc">C10_API</span> <span class="nl">IndexError</span> <span class="p">:</span> <span class="k">public</span> <span class="n">Error</span> <span class="p">{</span>
  <span class="k">using</span> <span class="n">Error</span><span class="o">::</span><span class="n">Error</span><span class="p">;</span>
<span class="p">};</span>


<span class="c1">// A utility function to return an exception std::string by prepending its</span>
<span class="c1">// exception type before its what() content</span>
<span class="n">C10_API</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">GetExceptionString</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span> <span class="n">e</span><span class="p">);</span>

<span class="k">namespace</span> <span class="n">detail</span> <span class="p">{</span>

<span class="c1">// Return x if it is non-empty; otherwise return y.</span>
<span class="kr">inline</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">if_empty_then</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">x</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">y</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="p">}</span>


<span class="p">}</span> <span class="c1">// namespace c10</span>

<span class="c1">// Private helper macro for implementing TORCH_INTERNAL_ASSERT and TORCH_CHECK</span>
<span class="c1">//</span>
<span class="c1">// Note: In the debug build With MSVC, __LINE__ might be of long type (a.k.a int32_t),</span>
<span class="c1">// which is different from the definition of `SourceLocation` that requires</span>
<span class="c1">// unsigned int (a.k.a uint32_t) and may cause a compile error with the message:</span>
<span class="c1">// error C2397: conversion from &#39;long&#39; to &#39;uint32_t&#39; requires a narrowing conversion</span>
<span class="c1">// Here the static cast is used to pass the build.</span>
<span class="cp">#define C10_THROW_ERROR(err_type, msg) \</span>
<span class="cp">  throw ::c10::err_type({__func__, __FILE__, static_cast&lt;uint32_t&gt;(__LINE__)}, msg)</span>

<span class="c1">// Private helper macro for workaround MSVC misexpansion of nested macro</span>
<span class="c1">// invocations involving __VA_ARGS__.  See</span>
<span class="c1">// https://stackoverflow.com/questions/5134523/msvc-doesnt-expand-va-args-correctly</span>
<span class="cp">#define C10_EXPAND_MSVC_WORKAROUND(x) x</span>

<span class="c1">// On nvcc, C10_UNLIKELY thwarts missing return statement analysis.  In cases</span>
<span class="c1">// where the unlikely expression may be a constant, use this macro to ensure</span>
<span class="c1">// return statement analysis keeps working (at the cost of not getting the</span>
<span class="c1">// likely/unlikely annotation on nvcc). https://github.com/pytorch/pytorch/issues/21418</span>
<span class="c1">//</span>
<span class="c1">// Currently, this is only used in the error reporting macros below.  If you</span>
<span class="c1">// want to use it more generally, move me to Macros.h</span>
<span class="c1">//</span>
<span class="c1">// TODO: Brian Vaughan observed that we might be able to get this to work on nvcc</span>
<span class="c1">// by writing some sort of C++ overload that distinguishes constexpr inputs</span>
<span class="c1">// from non-constexpr.  Since there isn&#39;t any evidence that losing C10_UNLIKELY</span>
<span class="c1">// in nvcc is causing us perf problems, this is not yet implemented, but this</span>
<span class="c1">// might be an interesting piece of C++ code for an intrepid bootcamper to</span>
<span class="c1">// write.</span>
<span class="cp">#if defined(__CUDACC__)</span>
<span class="cp">#define C10_UNLIKELY_OR_CONST(e) e</span>
<span class="cp">#else</span>
<span class="cp">#define C10_UNLIKELY_OR_CONST(e) C10_UNLIKELY(e)</span>
<span class="cp">#endif</span>


<span class="c1">// ----------------------------------------------------------------------------</span>
<span class="c1">// Error reporting macros</span>
<span class="c1">// ----------------------------------------------------------------------------</span>

<span class="c1">// A utility macro to provide assert()-like functionality; that is, enforcement</span>
<span class="c1">// of internal invariants in code.  It supports an arbitrary number of extra</span>
<span class="c1">// arguments (evaluated only on failure), which will be printed in the assert</span>
<span class="c1">// failure message using operator&lt;&lt; (this is useful to print some variables</span>
<span class="c1">// which may be useful for debugging.)</span>
<span class="c1">//</span>
<span class="c1">// Usage:</span>
<span class="c1">//    TORCH_INTERNAL_ASSERT(should_be_true);</span>
<span class="c1">//    TORCH_INTERNAL_ASSERT(x == 0, &quot;x = &quot;, x);</span>
<span class="c1">//</span>
<span class="c1">// Assuming no bugs in PyTorch, the conditions tested by this macro should</span>
<span class="c1">// always be true; e.g., it should be possible to disable all of these</span>
<span class="c1">// conditions without changing observable user behavior.  If you would like to</span>
<span class="c1">// do error reporting for user input, please use TORCH_CHECK instead.</span>
<span class="c1">//</span>
<span class="c1">// NOTE: It is SAFE to use this macro in production code; on failure, this</span>
<span class="c1">// simply raises an exception, it does NOT unceremoniously quit the process</span>
<span class="c1">// (unlike assert()).</span>
<span class="c1">//</span>
<span class="cp">#ifdef C10_MOBILE</span>
<span class="cp">#define TORCH_INTERNAL_ASSERT(cond, ...)      \</span>
<span class="cp">  if (C10_UNLIKELY_OR_CONST(!(cond))) {       \</span>
<span class="cp">    C10_THROW_ERROR(Error,                    \</span>
<span class="cp">        #cond &quot; INTERNAL ASSERT FAILED at&quot;    \</span>
<span class="cp">        __FILE__                              \</span>
<span class="cp">    );                                        \</span>
<span class="cp">  }</span>
<span class="cp">#else</span>
<span class="cp">#define TORCH_INTERNAL_ASSERT(cond, ...)      \</span>
<span class="cp">  if (C10_UNLIKELY_OR_CONST(!(cond))) {       \</span>
<span class="cp">    C10_THROW_ERROR(Error, ::c10::str(        \</span>
<span class="cp">        #cond &quot; INTERNAL ASSERT FAILED at &quot;,  \</span>
<span class="cp">        __FILE__,                             \</span>
<span class="cp">        &quot;:&quot;,                                  \</span>
<span class="cp">        __LINE__,                             \</span>
<span class="cp">        &quot;, please report a bug to PyTorch. &quot;, \</span>
<span class="cp">        ::c10::str(__VA_ARGS__)               \</span>
<span class="cp">    ));                                       \</span>
<span class="cp">  }</span>
<span class="cp">#endif</span>

<span class="c1">// A utility macro to make it easier to test for error conditions from user</span>
<span class="c1">// input.  Like TORCH_INTERNAL_ASSERT, it supports an arbitrary number of extra</span>
<span class="c1">// arguments (evaluated only on failure), which will be printed in the error</span>
<span class="c1">// message using operator&lt;&lt; (e.g., you can pass any object which has</span>
<span class="c1">// operator&lt;&lt; defined.  Most objects in PyTorch have these definitions!)</span>
<span class="c1">//</span>
<span class="c1">// Usage:</span>
<span class="c1">//    TORCH_CHECK(should_be_true); // A default error message will be provided</span>
<span class="c1">//                                 // in this case; but we recommend writing an</span>
<span class="c1">//                                 // explicit error message, as it is more</span>
<span class="c1">//                                 // user friendly.</span>
<span class="c1">//    TORCH_CHECK(x == 0, &quot;Expected x to be 0, but got &quot;, x);</span>
<span class="c1">//</span>
<span class="c1">// On failure, this macro will raise an exception.  If this exception propagates</span>
<span class="c1">// to Python, it will convert into a Python RuntimeError.</span>
<span class="c1">//</span>
<span class="c1">// NOTE: It is SAFE to use this macro in production code; on failure, this</span>
<span class="c1">// simply raises an exception, it does NOT unceremoniously quit the process</span>
<span class="c1">// (unlike CHECK() from glog.)</span>
<span class="c1">//</span>
<span class="cp">#ifdef C10_MOBILE</span>
<span class="cp">#define TORCH_CHECK(cond, ...)                \</span>
<span class="cp">  if (C10_UNLIKELY_OR_CONST(!(cond))) {       \</span>
<span class="cp">    C10_THROW_ERROR(Error,                    \</span>
<span class="cp">        #cond &quot; CHECK FAILED at &quot;             \</span>
<span class="cp">        __FILE__                              \</span>
<span class="cp">    );                                        \</span>
<span class="cp">  }</span>
<span class="cp">#else</span>
<span class="cp">#define TORCH_CHECK(cond, ...)                              \</span>
<span class="cp">  if (C10_UNLIKELY_OR_CONST(!(cond))) {                     \</span>
<span class="cp">    C10_THROW_ERROR(Error,                                  \</span>
<span class="cp">      ::c10::detail::if_empty_then(                         \</span>
<span class="cp">        ::c10::str(__VA_ARGS__),                            \</span>
<span class="cp">        &quot;Expected &quot; #cond &quot; to be true, but got false.  &quot;   \</span>
<span class="cp">        &quot;(Could this error message be improved?  If so, &quot;   \</span>
<span class="cp">        &quot;please report an enhancement request to PyTorch.)&quot; \</span>
<span class="cp">      )                                                     \</span>
<span class="cp">    );                                                      \</span>
<span class="cp">  }</span>
<span class="cp">#endif</span>
<span class="c1">// TODO: We&#39;re going to get a lot of similar looking string literals</span>
<span class="c1">// this way; check if this actually affects binary size.</span>

<span class="c1">// Like TORCH_CHECK, but raises IndexErrors instead of Errors.</span>
<span class="cp">#ifdef C10_MOBILE</span>
<span class="cp">#define TORCH_CHECK_INDEX(cond, ...)          \</span>
<span class="cp">  if (C10_UNLIKELY_OR_CONST(!(cond))) {       \</span>
<span class="cp">    C10_THROW_ERROR(Error,                    \</span>
<span class="cp">        #cond &quot; INDEX CHECK FAILED at &quot;       \</span>
<span class="cp">        __FILE__                              \</span>
<span class="cp">    );                                        \</span>
<span class="cp">  }</span>
<span class="cp">#else</span>
<span class="cp">#define TORCH_CHECK_INDEX(cond, ...)                        \</span>
<span class="cp">  if (C10_UNLIKELY_OR_CONST(!(cond))) {                     \</span>
<span class="cp">    C10_THROW_ERROR(IndexError,                             \</span>
<span class="cp">      ::c10::detail::if_empty_then(                         \</span>
<span class="cp">        ::c10::str(__VA_ARGS__),                            \</span>
<span class="cp">        &quot;Expected &quot; #cond &quot; to be true, but got false.  &quot;   \</span>
<span class="cp">        &quot;(Could this error message be improved?  If so, &quot;   \</span>
<span class="cp">        &quot;please report an enhancement request to PyTorch.)&quot; \</span>
<span class="cp">      )                                                     \</span>
<span class="cp">    );                                                      \</span>
<span class="cp">  }</span>
<span class="cp">#endif</span>


<span class="c1">// Report a warning to the user.  Accepts an arbitrary number of extra</span>
<span class="c1">// arguments which are concatenated into the warning message using operator&lt;&lt;</span>
<span class="c1">//</span>
<span class="cp">#define TORCH_WARN(...) \</span>
<span class="cp">  ::c10::Warning::warn({__func__, __FILE__, static_cast&lt;uint32_t&gt;(__LINE__)}, ::c10::str(__VA_ARGS__))</span>


<span class="c1">// ----------------------------------------------------------------------------</span>
<span class="c1">// Deprecated macros</span>
<span class="c1">// ----------------------------------------------------------------------------</span>

<span class="k">namespace</span> <span class="n">c10</span> <span class="p">{</span> <span class="k">namespace</span> <span class="n">detail</span> <span class="p">{</span>

<span class="cm">/*</span>
<span class="cm">// Deprecation disabled until we fix sites in our codebase</span>
<span class="cm">C10_DEPRECATED_MESSAGE(&quot;AT_ERROR(msg) is deprecated, use TORCH_CHECK(false, msg) instead.&quot;)</span>
<span class="cm">*/</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="n">deprecated_AT_ERROR</span><span class="p">()</span> <span class="p">{}</span>

<span class="cm">/*</span>
<span class="cm">// Deprecation disabled until we fix sites in our codebase</span>
<span class="cm">C10_DEPRECATED_MESSAGE(&quot;AT_INDEX_ERROR(msg) is deprecated, use TORCH_CHECK_INDEX(false, msg) instead.&quot;)</span>
<span class="cm">*/</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="n">deprecated_AT_INDEX_ERROR</span><span class="p">()</span> <span class="p">{}</span>

<span class="cm">/*</span>
<span class="cm">// Deprecation disabled until we fix sites in our codebase</span>
<span class="cm">C10_DEPRECATED_MESSAGE(&quot;AT_WARN is deprecated, use TORCH_WARN instead.&quot;)</span>
<span class="cm">*/</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="n">deprecated_AT_WARN</span><span class="p">()</span> <span class="p">{}</span>

<span class="n">C10_DEPRECATED_MESSAGE</span><span class="p">(</span><span class="s">&quot;AT_CHECK is deprecated, use TORCH_CHECK instead.&quot;</span><span class="p">)</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="n">deprecated_AT_CHECK</span><span class="p">()</span> <span class="p">{}</span>

<span class="cm">/*</span>
<span class="cm">// Deprecation disabled until we fix sites in our codebase</span>
<span class="cm">C10_DEPRECATED_MESSAGE(&quot;AT_ASSERT is deprecated, if you mean to indicate an internal invariant failure, use &quot; \</span>
<span class="cm">                       &quot;TORCH_INTERNAL_ASSERT instead; if you mean to do user error checking, use &quot; \</span>
<span class="cm">                       &quot;TORCH_CHECK.  See https://github.com/pytorch/pytorch/issues/20287 for more details.&quot;)</span>
<span class="cm">*/</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="n">deprecated_AT_ASSERT</span><span class="p">()</span> <span class="p">{}</span>

<span class="cm">/*</span>
<span class="cm">// Deprecation disabled until we fix sites in our codebase</span>
<span class="cm">C10_DEPRECATED_MESSAGE(&quot;AT_ASSERTM is deprecated, if you mean to indicate an internal invariant failure, use &quot; \</span>
<span class="cm">                       &quot;TORCH_INTERNAL_ASSERT instead; if you mean to do user error checking, use &quot; \</span>
<span class="cm">                       &quot;TORCH_CHECK.  See https://github.com/pytorch/pytorch/issues/20287 for more details.&quot;)</span>
<span class="cm">*/</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="n">deprecated_AT_ASSERTM</span><span class="p">()</span> <span class="p">{}</span>

<span class="p">}}</span> <span class="c1">// namespace c10::detail</span>

<span class="c1">// Deprecated alias; this alias was deprecated because it wasn&#39;t clear to</span>
<span class="c1">// people that you should use a macro with AT_ prefix inside the torch/csrc</span>
<span class="c1">// directory.  Use TORCH_CHECK instead.</span>
<span class="cp">#define AT_CHECK(...)                                     \</span>
<span class="cp">  do {                                                    \</span>
<span class="cp">    ::c10::detail::deprecated_AT_CHECK();                 \</span>
<span class="cp">    C10_EXPAND_MSVC_WORKAROUND(TORCH_CHECK(__VA_ARGS__)); \</span>
<span class="cp">  } while (false)</span>

<span class="c1">// Deprecated alias; this alias was deprecated because people kept mistakenly</span>
<span class="c1">// using it for user error checking.  Use TORCH_INTERNAL_ASSERT or TORCH_CHECK</span>
<span class="c1">// instead. See https://github.com/pytorch/pytorch/issues/20287 for more details.</span>
<span class="cp">#define AT_ASSERT(...)                                              \</span>
<span class="cp">  do {                                                              \</span>
<span class="cp">    ::c10::detail::deprecated_AT_ASSERT();                          \</span>
<span class="cp">    C10_EXPAND_MSVC_WORKAROUND(TORCH_INTERNAL_ASSERT(__VA_ARGS__)); \</span>
<span class="cp">  } while (false)</span>

<span class="c1">// Deprecated alias, like AT_ASSERT.  The new TORCH_INTERNAL_ASSERT macro supports</span>
<span class="c1">// both 0-ary and variadic calls, so having a separate message-accepting macro</span>
<span class="c1">// is not necessary.</span>
<span class="c1">//</span>
<span class="c1">// NB: we MUST include cond explicitly here, as MSVC will miscompile the macro</span>
<span class="c1">// expansion, shunting all of __VA_ARGS__ to cond.  An alternate workaround</span>
<span class="c1">// can be seen at</span>
<span class="c1">// https://stackoverflow.com/questions/5134523/msvc-doesnt-expand-va-args-correctly</span>
<span class="cp">#define AT_ASSERTM(cond, ...)                                                 \</span>
<span class="cp">  do {                                                                        \</span>
<span class="cp">    ::c10::detail::deprecated_AT_ASSERTM();                                   \</span>
<span class="cp">    C10_EXPAND_MSVC_WORKAROUND(TORCH_INTERNAL_ASSERT(cond, __VA_ARGS__));     \</span>
<span class="cp">  } while (false)</span>

<span class="c1">// Deprecated alias; this alias was deprecated because it represents extra API</span>
<span class="c1">// surface that makes it hard for people to understand what macro to use.</span>
<span class="c1">// Use TORCH_CHECK(false, ...) or TORCH_INTERNAL_ASSERT(false, ...) to</span>
<span class="c1">// unconditionally fail at a line of code.</span>
<span class="cp">#define AT_ERROR(...)                                                         \</span>
<span class="cp">  do {                                                                        \</span>
<span class="cp">    ::c10::detail::deprecated_AT_ERROR();                                     \</span>
<span class="cp">    C10_EXPAND_MSVC_WORKAROUND(TORCH_CHECK(false, ::c10::str(__VA_ARGS__)));  \</span>
<span class="cp">  } while (false)</span>

<span class="c1">// Deprecated alias; this alias was deprecated for consistency with TORCH_CHECK.</span>
<span class="cp">#define AT_INDEX_ERROR(...)                                                         \</span>
<span class="cp">  do {                                                                              \</span>
<span class="cp">    ::c10::detail::deprecated_AT_INDEX_ERROR();                                     \</span>
<span class="cp">    C10_EXPAND_MSVC_WORKAROUND(TORCH_CHECK_INDEX(false, ::c10::str(__VA_ARGS__)));  \</span>
<span class="cp">  } while (false)</span>

<span class="c1">// Deprecated alias; this alias was deprecated because it wasn&#39;t clear to</span>
<span class="c1">// people that you should use a macro with AT_ prefix inside the torch/csrc</span>
<span class="c1">// directory.  Use TORCH_WARN instead.</span>
<span class="cp">#define AT_WARN(...)                                      \</span>
<span class="cp">  do {                                                    \</span>
<span class="cp">    ::c10::detail::deprecated_AT_WARN();                  \</span>
<span class="cp">    C10_EXPAND_MSVC_WORKAROUND(TORCH_WARN(__VA_ARGS__));  \</span>
<span class="cp">  } while (false)</span>


<span class="cp">#endif </span><span class="c1">// C10_UTIL_EXCEPTION_H_</span>
</pre></div>
</div>
</div>


             </article>
             
            </div>
            <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Torch Contributors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Program Listing for File Exception.h</a></li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
         <script type="text/javascript" src="../_static/jquery.js"></script>
         <script type="text/javascript" src="../_static/underscore.js"></script>
         <script type="text/javascript" src="../_static/doctools.js"></script>
         <script type="text/javascript" src="../_static/language_data.js"></script>
         <script type="text/javascript" src="../_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
         <script type="text/javascript" src="../_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
     

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for PyTorch</p>
          <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
            <li><a href="https://pytorch.org/get-started">Get Started</a></li>
            <li><a href="https://pytorch.org/features">Features</a></li>
            <li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
            <li><a href="https://pytorch.org/blog/">Blog</a></li>
            <li><a href="https://pytorch.org/resources">Resources</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/support">Support</a></li>
            <li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
            <li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
            <li><a href="https://discuss.pytorch.org" target="_blank">Discuss</a></li>
            <li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://pytorch.slack.com" target="_blank">Slack</a></li>
            <li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md" target="_blank">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <ul>
            <li class="list-title">Follow Us</li>
            <li>
              <div id="mc_embed_signup">
                <form
                  action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&id=91d0dccd39"
                  method="post"
                  id="mc-embedded-subscribe-form"
                  name="mc-embedded-subscribe-form"
                  class="email-subscribe-form validate"
                  target="_blank"
                  novalidate>
                  <div id="mc_embed_signup_scroll" class="email-subscribe-form-fields-wrapper">
                    <div class="mc-field-group">
                      <label for="mce-EMAIL" style="display:none;">Email Address</label>
                      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
                    </div>

                    <div id="mce-responses" class="clear">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->

                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" value=""></div>

                    <div class="clear">
                      <input type="submit" value="" name="subscribe" id="mc-embedded-subscribe" class="button email-subscribe-button">
                    </div>
                  </div>
                </form>
              </div>

            </li>
          </ul>

          <div class="footer-social-icons">
            <a href="https://www.facebook.com/pytorch" target="_blank" class="facebook"></a>
            <a href="https://twitter.com/pytorch" target="_blank" class="twitter"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="#">Get Started</a>
          </li>

          <li>
            <a href="#">Features</a>
          </li>

          <li>
            <a href="#">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li class="active">
            <a href="https://pytorch.org/docs/stable/index.html">Docs</a>
          </li>

          <li>
            <a href="https://pytorch.org/resources">Resources</a>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>