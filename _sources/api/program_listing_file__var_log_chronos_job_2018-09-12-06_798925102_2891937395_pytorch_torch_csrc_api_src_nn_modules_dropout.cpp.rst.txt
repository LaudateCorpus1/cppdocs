:github_url: https://github.com/pytorch/pytorch


.. _program_listing_file__var_log_chronos_job_2018-09-12-06_798925102_2891937395_pytorch_torch_csrc_api_src_nn_modules_dropout.cpp:

Program Listing for File dropout.cpp
====================================

- Return to documentation for :ref:`file__var_log_chronos_job_2018-09-12-06_798925102_2891937395_pytorch_torch_csrc_api_src_nn_modules_dropout.cpp`

.. code-block:: cpp

   #include <torch/nn/modules/dropout.h>
   
   #include <torch/tensor.h>
   
   #include <ATen/core/Error.h>
   
   #include <cstddef>
   #include <vector>
   
   namespace torch {
   namespace nn {
   namespace detail {
   template <typename Derived>
   DropoutImplBase<Derived>::DropoutImplBase(DropoutOptions options_)
       : options(options_) {
     AT_CHECK(options.rate_ >= 0, "Dropout rate must not be less than zero");
     AT_CHECK(options.rate_ <= 1, "Dropout rate must not be greater than one");
   }
   
   template <typename Derived>
   void DropoutImplBase<Derived>::reset() {}
   
   template class DropoutImplBase<DropoutImpl>;
   template class DropoutImplBase<FeatureDropoutImpl>;
   } // namespace detail
   
   DropoutOptions::DropoutOptions(double rate) : rate_(rate) {}
   
   Tensor DropoutImpl::forward(Tensor input) {
     return torch::dropout(input, options.rate_, this->is_training());
   }
   
   Tensor FeatureDropoutImpl::forward(Tensor input) {
     return torch::feature_dropout(input, options.rate_, this->is_training());
   }
   } // namespace nn
   } // namespace torch
