:github_url: https://github.com/pytorch/pytorch


.. _program_listing_file__var_log_chronos_job_2018-09-12-19_798925102_2895917701_pytorch_torch_csrc_api_src_nn_modules_embedding.cpp:

Program Listing for File embedding.cpp
======================================

- Return to documentation for :ref:`file__var_log_chronos_job_2018-09-12-19_798925102_2895917701_pytorch_torch_csrc_api_src_nn_modules_embedding.cpp`

.. code-block:: cpp

   #include <torch/nn/modules/embedding.h>
   
   #include <torch/tensor.h>
   #include <torch/utils.h>
   
   #include <cstddef>
   #include <utility>
   #include <vector>
   
   namespace torch {
   namespace nn {
   
   EmbeddingOptions::EmbeddingOptions(int64_t count, int64_t dimension)
       : count_(count), dimension_(dimension) {}
   
   EmbeddingImpl::EmbeddingImpl(EmbeddingOptions options)
       : options(std::move(options)) {
     reset();
   }
   
   void EmbeddingImpl::reset() {
     weight = register_parameter(
         "weight", torch::empty({options.count_, options.dimension_}));
     NoGradGuard guard;
     weight.normal_(0, 1);
   }
   
   Tensor EmbeddingImpl::forward(Tensor input) {
     return torch::embedding(weight, /*indices=*/input);
   }
   } // namespace nn
   } // namespace torch
